---
title: Setting up neomutt for Glasgow Uni Email
date: 2021-02-21 00:00:00 +/-TTTT
categories: [Dev workflow, Tools]
tags: [linux]     # TAG names should always be lowercase
---

<h1>Using mutt for Glasgow University email</h1>
<p>This post details setting up mutt (specifically neomutt) to work with the new Glasgow University OAuth2.0 system.</p>
<p>I mainly suppliment the information already available.</p>
<p>Namely, I figured out how to configure my client using the following:</p>
<p><a href='https://www.dcs.gla.ac.uk/~jacobd/posts/2022/03/configure-mutt-to-work-with-oauth-20/'>A post by Dejice Jacob on the same topic</a></p>
<p><a href='https://www.vanormondt.net/~peter/blog/2021-03-16-mutt-office365-mfa.html'>Peter van Ormondt's guide on mutt for outlook OAuth</a></p>
<p><a href='http://homepages.warwick.ac.uk/staff/Mike.Willis/o365/mutt.html'>The University of Warwick guide for mutt by Mike Willis</a></p>
<p>I hope to provide a bit more information that helped me complete my config.</p>
<h2>Setting up mutt in general</h2>
<p>I use the mutt-wizard to configure neomutt and use all the optional dependencies except mpop.</p>
<p><a href='https://github.com/LukeSmithxyz/mutt-wizard'>mutt-wizard</a></p>
<h2>University email</h2>
<p>The next step is to get the OAuth2.0 script needed to periodically fetch your token.</p>
<p>This process is detailed in the post by Dejice Jacob and in the guide by Peter van Ormondt.</p>
<p>Once you have neomutt working and the script and token file created *do not* use the mw command to add an account.</p>
<p>Mutt-wizard only configures plain authentication so it will just create a bunch of configs that you will then need to track down and delete.</p>
<p>Instead you need to manually create a config file for your account.</p>
<pre><code>
touch ~/.config/mutt/accounts/your@email.here.muttrc
</code></pre>
<p>We then need to edit this config.</p>
<p>My university email address uses @researc.gla.ac.uk.</p>
<p>If you instead use @student.gla.ac.uk or whatever remember to change that part, as well as the parts of this config that pertain to your details.</p>
<pre><code>
set from                       = "your_email_here@research.gla.ac.uk"
set realname                   = "Your name"
set hostname                   = "gla.ac.uk"
set imap_user                  = "your_email_here@research.gla.ac.uk"
set smtp_pass                  = "Your password here"
set imap_pass                  = "Your password here"
set folder                     = "imaps://your_email_here@research.gla.ac.uk@outlook.office365.com"
set postponed                  = +Drafts
set record                     = +"Sent Items"
set trash                      = "+Deleted Items"
set smtp_url                   = "smtp://your_email_here@research.gla.ac.uk@smtp.office365.com:587"
set spoolfile                  = "imaps://your_email_here@research.gla.ac.uk@outlook.office365.com/INBOX"
set imap_authenticators        = "oauthbearer:xoauth2"
set imap_oauth_refresh_command = "/CHANGE/ME/mutt/mutt_oauth2.py /CHANGE/ME/mutt/TOKEN_FILENAME"
set smtp_authenticators        = ${imap_authenticators}
set smtp_oauth_refresh_command = ${imap_oauth_refresh_command}

mailboxes "=INBOX" "=Sent Items" "=Deleted Items"
</code></pre>
<p>You can add any extra mailboxes needed by editing the last line of the config.</p>
<p>This config will store your password this way which is not great.</p>
<p>You can instead use any utility such as pass to encrypt it.</p>
<p><a href='https://wiki.archlinux.org/title/Pass'>pass</a></p>
